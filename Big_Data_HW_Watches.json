{
  "paragraphs": [
    {
      "title": "",
      "text": "%pyspark\n# Read in data from S3 Buckets\nfrom pyspark import SparkFiles\nurl \u003d\"https://s3.amazonaws.com/amazon-reviews-pds/tsv/amazon_reviews_us_Watches_v1_00.tsv.gz\"\nspark.sparkContext.addFile(url)\ndf \u003d spark.read.csv(SparkFiles.get(\"amazon_reviews_us_Watches_v1_00.tsv.gz\"), sep\u003d\"\\t\", header\u003dTrue)\n\n# Show DataFrame\ndf.show(5)",
      "user": "",
      "dateUpdated": "2019-05-10 03:28:21.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n|marketplace|customer_id|     review_id|product_id|product_parent|       product_title|product_category|star_rating|helpful_votes|total_votes|vine|verified_purchase|     review_headline|         review_body|review_date|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n|         US|    3653882|R3O9SGZBVQBV76|B00FALQ1ZC|     937001370|Invicta Women\u0027s 1...|         Watches|          5|            0|          0|   N|                Y|          Five Stars|Absolutely love t...| 2015-08-31|\n|         US|   14661224| RKH8BNC3L5DLF|B00D3RGO20|     484010722|Kenneth Cole New ...|         Watches|          5|            0|          0|   N|                Y|I love thiswatch ...|I love this watch...| 2015-08-31|\n|         US|   27324930|R2HLE8WKZSU3NL|B00DKYC7TK|     361166390|Ritche 22mm Black...|         Watches|          2|            1|          1|   N|                Y|           Two Stars|           Scratches| 2015-08-31|\n|         US|    7211452|R31U3UH5AZ42LL|B000EQS1JW|     958035625|Citizen Men\u0027s BM8...|         Watches|          5|            0|          0|   N|                Y|          Five Stars|It works well on ...| 2015-08-31|\n|         US|   12733322|R2SV659OUJ945Y|B00A6GFD7S|     765328221|Orient ER27009B M...|         Watches|          4|            0|          0|   N|                Y|Beautiful face, b...|Beautiful watch f...| 2015-08-31|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_1332805920",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 03:27:40.795",
      "dateFinished": "2019-05-10 03:28:21.766",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nprint(df.count())\ndf \u003d df.dropna()\nprint(df.count())\ndf \u003d df.dropDuplicates()\nprint(df.count())",
      "user": "",
      "dateUpdated": "2019-05-10 03:29:44.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "960872\n960679\n960679\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_494878320",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 03:29:10.708",
      "dateFinished": "2019-05-10 03:29:44.614",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\ndf.printSchema",
      "user": "",
      "dateUpdated": "2019-05-10 01:28:29.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cbound method DataFrame.printSchema of DataFrame[marketplace: string, customer_id: string, review_id: string, product_id: string, product_parent: string, product_title: string, product_category: string, star_rating: string, helpful_votes: string, total_votes: string, vine: string, verified_purchase: string, review_headline: string, review_body: string, review_date: string]\u003e",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_1445973331",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 01:28:29.858",
      "dateFinished": "2019-05-10 01:28:29.971",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nfrom pyspark.sql.types import StructField, StringType, IntegerType, StructType\nfrom pyspark.sql.types import DateType\n\nschema \u003d [StructField(\"marketplace\", StringType(), True),\\\n          StructField(\"customer_id\", IntegerType(), True),\\\n          StructField(\"review_id\", StringType(), True),\\\n          StructField(\"product_id\", StringType(), True),\\\n          StructField(\"product_parent\", IntegerType(), True),\\\n          StructField(\"product_title\", StringType(), True),\\\n          StructField(\"product_category\", StringType(), True),\\\n          StructField(\"star_rating\", IntegerType(), True),\\\n          StructField(\"helpful_votes\", IntegerType(), True),\\\n          StructField(\"total_votes\", IntegerType(), True),\\\n          StructField(\"vine\", StringType(), True),\\\n          StructField(\"verified_purchase\", StringType(), True),\\\n          StructField(\"review_headline\", StringType(), True),\\\n          StructField(\"review_body\", StringType(), True),\\\n          StructField(\"review_date\", DateType(), True)\\\n          ,]\n\nschema",
      "user": "",
      "dateUpdated": "2019-05-10 03:32:13.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "[StructField(marketplace,StringType,true),\n StructField(customer_id,IntegerType,true),\n StructField(review_id,StringType,true),\n StructField(product_id,StringType,true),\n StructField(product_parent,IntegerType,true),\n StructField(product_title,StringType,true),\n StructField(product_category,StringType,true),\n StructField(star_rating,IntegerType,true),\n StructField(helpful_votes,IntegerType,true),\n StructField(total_votes,IntegerType,true),\n StructField(vine,StringType,true),\n StructField(verified_purchase,StringType,true),\n StructField(review_headline,StringType,true),\n StructField(review_body,StringType,true),\n StructField(review_date,DateType,true)]",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_130610373",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 03:32:13.399",
      "dateFinished": "2019-05-10 03:32:13.514",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nfinal \u003d StructType(fields\u003dschema)\nfinal",
      "user": "",
      "dateUpdated": "2019-05-10 03:32:16.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "StructType(List(StructField(marketplace,StringType,true),StructField(customer_id,IntegerType,true),StructField(review_id,StringType,true),StructField(product_id,StringType,true),StructField(product_parent,IntegerType,true),StructField(product_title,StringType,true),StructField(product_category,StringType,true),StructField(star_rating,IntegerType,true),StructField(helpful_votes,IntegerType,true),StructField(total_votes,IntegerType,true),StructField(vine,StringType,true),StructField(verified_purchase,StringType,true),StructField(review_headline,StringType,true),StructField(review_body,StringType,true),StructField(review_date,DateType,true)))",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_171978900",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 03:32:16.664",
      "dateFinished": "2019-05-10 03:32:16.777",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ndataframe \u003d spark.read.csv(SparkFiles.get(\"amazon_reviews_us_Watches_v1_00.tsv.gz\"), sep\u003d\"\\t\", schema\u003dfinal, header\u003dTrue)\ndataframe.show(5)",
      "user": "",
      "dateUpdated": "2019-05-10 03:32:23.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n|marketplace|customer_id|     review_id|product_id|product_parent|       product_title|product_category|star_rating|helpful_votes|total_votes|vine|verified_purchase|     review_headline|         review_body|review_date|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\n|         US|    3653882|R3O9SGZBVQBV76|B00FALQ1ZC|     937001370|Invicta Women\u0027s 1...|         Watches|          5|            0|          0|   N|                Y|          Five Stars|Absolutely love t...| 2015-08-31|\n|         US|   14661224| RKH8BNC3L5DLF|B00D3RGO20|     484010722|Kenneth Cole New ...|         Watches|          5|            0|          0|   N|                Y|I love thiswatch ...|I love this watch...| 2015-08-31|\n|         US|   27324930|R2HLE8WKZSU3NL|B00DKYC7TK|     361166390|Ritche 22mm Black...|         Watches|          2|            1|          1|   N|                Y|           Two Stars|           Scratches| 2015-08-31|\n|         US|    7211452|R31U3UH5AZ42LL|B000EQS1JW|     958035625|Citizen Men\u0027s BM8...|         Watches|          5|            0|          0|   N|                Y|          Five Stars|It works well on ...| 2015-08-31|\n|         US|   12733322|R2SV659OUJ945Y|B00A6GFD7S|     765328221|Orient ER27009B M...|         Watches|          4|            0|          0|   N|                Y|Beautiful face, b...|Beautiful watch f...| 2015-08-31|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-----------+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_2087434028",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 03:32:22.958",
      "dateFinished": "2019-05-10 03:32:23.272",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nreview_id_table \u003d dataframe.select([\"review_id\", \"customer_id\", \"product_id\", \"product_parent\", \"review_date\"])\n\nreview_id_table.show(5)\n",
      "user": "",
      "dateUpdated": "2019-05-10 01:28:40.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+----------+--------------+-----------+\n|     review_id|customer_id|product_id|product_parent|review_date|\n+--------------+-----------+----------+--------------+-----------+\n|R3O9SGZBVQBV76|    3653882|B00FALQ1ZC|     937001370| 2015-08-31|\n| RKH8BNC3L5DLF|   14661224|B00D3RGO20|     484010722| 2015-08-31|\n|R2HLE8WKZSU3NL|   27324930|B00DKYC7TK|     361166390| 2015-08-31|\n|R31U3UH5AZ42LL|    7211452|B000EQS1JW|     958035625| 2015-08-31|\n|R2SV659OUJ945Y|   12733322|B00A6GFD7S|     765328221| 2015-08-31|\n+--------------+-----------+----------+--------------+-----------+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_1181305707",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 01:28:40.429",
      "dateFinished": "2019-05-10 01:28:40.694",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nproducts \u003d dataframe.select([\"product_id\", \"product_title\"])\n\nproducts.show(5)\n\n",
      "user": "",
      "dateUpdated": "2019-05-10 01:28:46.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----------+--------------------+\n|product_id|       product_title|\n+----------+--------------------+\n|B00FALQ1ZC|Invicta Women\u0027s 1...|\n|B00D3RGO20|Kenneth Cole New ...|\n|B00DKYC7TK|Ritche 22mm Black...|\n|B000EQS1JW|Citizen Men\u0027s BM8...|\n|B00A6GFD7S|Orient ER27009B M...|\n+----------+--------------------+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_1008124466",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 01:28:46.254",
      "dateFinished": "2019-05-10 01:28:46.424",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncustomer_table \u003d dataframe.select([\"customer_id\"])\n\ncustomer_table.show(10)",
      "user": "",
      "dateUpdated": "2019-05-10 01:28:49.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+\n|customer_id|\n+-----------+\n|    3653882|\n|   14661224|\n|   27324930|\n|    7211452|\n|   12733322|\n|    6576411|\n|   11811565|\n|   49401598|\n|   45925069|\n|   44751341|\n+-----------+\nonly showing top 10 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_1072730057",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 01:28:49.524",
      "dateFinished": "2019-05-10 01:28:49.737",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ndef dfZipWithIndex(df, offset\u003d1, colName\u003d\"rowId\"):\n\n\n    new_schema \u003d StructType(\n\n        df.schema.fields  # previous schema\n        +[StructField(colName, LongType(), True)]  # new added field to back\n    )\n\n    zipped_rdd \u003d df.rdd.zipWithIndex()\n\n    new_rdd \u003d zipped_rdd.map(lambda (row, rowId): (list(row) + [rowId + offset] ))\n\n    return spark.createDataFrame(new_rdd, new_schema)",
      "user": "",
      "dateUpdated": "2019-05-10 01:28:52.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_2017214769",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 01:28:52.249",
      "dateFinished": "2019-05-10 01:28:52.361",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nfrom pyspark.sql.types import LongType\ncustomer_table \u003d dfZipWithIndex(customer_table, offset\u003d1, colName\u003d\"customer_count\")\n\ncustomer_table.show(10)",
      "user": "",
      "dateUpdated": "2019-05-10 01:28:56.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+--------------+\n|customer_id|customer_count|\n+-----------+--------------+\n|    3653882|             1|\n|   14661224|             2|\n|   27324930|             3|\n|    7211452|             4|\n|   12733322|             5|\n|    6576411|             6|\n|   11811565|             7|\n|   49401598|             8|\n|   45925069|             9|\n|   44751341|            10|\n+-----------+--------------+\nonly showing top 10 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_1168546136",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 01:28:55.577",
      "dateFinished": "2019-05-10 01:28:56.441",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nvine_table \u003d dataframe.select([\"review_id\", \"star_rating\", \"helpful_votes\", \"total_votes\", \"vine\"])\n\nvine_table.show(5)\n",
      "user": "",
      "dateUpdated": "2019-05-10 03:32:30.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+-------------+-----------+----+\n|     review_id|star_rating|helpful_votes|total_votes|vine|\n+--------------+-----------+-------------+-----------+----+\n|R3O9SGZBVQBV76|          5|            0|          0|   N|\n| RKH8BNC3L5DLF|          5|            0|          0|   N|\n|R2HLE8WKZSU3NL|          2|            1|          1|   N|\n|R31U3UH5AZ42LL|          5|            0|          0|   N|\n|R2SV659OUJ945Y|          4|            0|          0|   N|\n+--------------+-----------+-------------+-----------+----+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_722747195",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-10 03:32:30.715",
      "dateFinished": "2019-05-10 03:32:30.981",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\navg_df \u003d vine_table.groupBy(\"vine\").avg()\navg_df.show()",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:24.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----+-----------------+------------------+-----------------+\n|vine| avg(star_rating)|avg(helpful_votes)| avg(total_votes)|\n+----+-----------------+------------------+-----------------+\n|   Y|4.034344590726961|2.8580423583285635|3.712077847738981|\n|   N| 4.13847204483253|1.1938016421217255|1.557187019418741|\n+----+-----------------+------------------+-----------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_886912423",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-06 22:09:17.660",
      "dateFinished": "2019-05-06 22:09:24.641",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nreviews_df \u003d dataframe.select([\"customer_id\", \"product_id\", \"product_title\", \"star_rating\", \"helpful_votes\", \"total_votes\", \"vine\"])\n\nreviews_df.show(5)",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:24.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|customer_id|product_id|       product_title|star_rating|helpful_votes|total_votes|vine|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|    3653882|B00FALQ1ZC|Invicta Women\u0027s 1...|          5|            0|          0|   N|\n|   14661224|B00D3RGO20|Kenneth Cole New ...|          5|            0|          0|   N|\n|   27324930|B00DKYC7TK|Ritche 22mm Black...|          2|            1|          1|   N|\n|    7211452|B000EQS1JW|Citizen Men\u0027s BM8...|          5|            0|          0|   N|\n|   12733322|B00A6GFD7S|Orient ER27009B M...|          4|            0|          0|   N|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-173452_396801452",
      "dateCreated": "2019-05-06 17:34:52.000",
      "dateStarted": "2019-05-06 22:09:24.642",
      "dateFinished": "2019-05-06 22:09:24.864",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark \n\n# Configure settings for RDS\nmode \u003d \"append\"\njdbc_url\u003d\"jdbc:postgresql://\u003cendpoint\u003e:5432/gwsis\"\nconfig \u003d {\"user\":\"\u003cusername\u003e\", \n          \"password\": \"\u003cpassword\u003e\", \n          \"driver\":\"org.postgresql.Driver\"}",
      "user": "",
      "dateUpdated": "2019-05-10 03:42:03.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190510-012538_1348094159",
      "dateCreated": "2019-05-10 01:25:38.000",
      "dateStarted": "2019-05-10 03:32:35.786",
      "dateFinished": "2019-05-10 03:32:35.899",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n# Append DataFrame to active_user table in RDS\n\nreview_id_table.write.jdbc(url\u003djdbc_url, table\u003d\u0027amazon_watches_review\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "2019-05-10 01:35:06.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190510-012607_1259167317",
      "dateCreated": "2019-05-10 01:26:07.000",
      "dateStarted": "2019-05-10 01:29:33.096",
      "dateFinished": "2019-05-10 01:35:06.994",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n# Write dataframe to billing_info table in RDS\n\nproducts.write.jdbc(url\u003djdbc_url, table\u003d\u0027amazon_watches_product_info\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "2019-05-10 01:41:56.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190510-013605_861985425",
      "dateCreated": "2019-05-10 01:36:05.000",
      "dateStarted": "2019-05-10 01:36:24.109",
      "dateFinished": "2019-05-10 01:41:56.108",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncustomer_table.write.jdbc(url\u003djdbc_url, table\u003d\u0027amazon_watches_customer_info\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "2019-05-10 01:48:21.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190510-013715_154371263",
      "dateCreated": "2019-05-10 01:37:15.000",
      "dateStarted": "2019-05-10 01:42:51.747",
      "dateFinished": "2019-05-10 01:48:21.815",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n# Write dataframe to payment_info table in RDS\n\nvine_table.write.jdbc(url\u003djdbc_url, table\u003d\u0027amazon_watches_vine_info\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "2019-05-10 03:38:15.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190510-014630_1272318150",
      "dateCreated": "2019-05-10 01:46:30.000",
      "dateStarted": "2019-05-10 03:32:42.173",
      "dateFinished": "2019-05-10 03:38:15.192",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nvine_only_set \u003d reviews_df.filter(reviews_df[\"vine\"] \u003d\u003d \"Y\")\n\nvine_only_set.show(5)",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:25.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|customer_id|product_id|       product_title|star_rating|helpful_votes|total_votes|vine|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|   52229317|B00QK2HAFK|Armitron Men\u0027s 20...|          4|            1|          2|   Y|\n|   42703596|B00T9K161Y|Armitron Sport Wo...|          4|            0|          0|   Y|\n|   49694646|B003XOT3T4|Swiss Legend Men\u0027...|          4|            0|          0|   Y|\n|   52408013|B003XOT3T4|Swiss Legend Men\u0027...|          4|            1|          2|   Y|\n|   32763194|B00UPTGHU8|Swiss Legend Men\u0027...|          4|            0|          1|   Y|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-174427_1507652190",
      "dateCreated": "2019-05-06 17:44:27.000",
      "dateStarted": "2019-05-06 22:09:24.865",
      "dateFinished": "2019-05-06 22:09:25.084",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nfrom pyspark.sql.functions import countDistinct\n\nvine_only_set.agg(countDistinct(vine_only_set.product_id).alias(\u0027unique_product_id\u0027)).collect()",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:31.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "[Row(unique_product_id\u003d176)]",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-174653_1391038327",
      "dateCreated": "2019-05-06 17:46:53.000",
      "dateStarted": "2019-05-06 22:09:25.086",
      "dateFinished": "2019-05-06 22:09:31.676",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nvine_no_set \u003d reviews_df.filter(reviews_df[\"vine\"] \u003d\u003d \"N\")\n\nvine_no_set.show(5)\n",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:31.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|customer_id|product_id|       product_title|star_rating|helpful_votes|total_votes|vine|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|    3653882|B00FALQ1ZC|Invicta Women\u0027s 1...|          5|            0|          0|   N|\n|   14661224|B00D3RGO20|Kenneth Cole New ...|          5|            0|          0|   N|\n|   27324930|B00DKYC7TK|Ritche 22mm Black...|          2|            1|          1|   N|\n|    7211452|B000EQS1JW|Citizen Men\u0027s BM8...|          5|            0|          0|   N|\n|   12733322|B00A6GFD7S|Orient ER27009B M...|          4|            0|          0|   N|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-174716_25361000",
      "dateCreated": "2019-05-06 17:47:16.000",
      "dateStarted": "2019-05-06 22:09:31.678",
      "dateFinished": "2019-05-06 22:09:31.842",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nvine_no_set.agg(countDistinct(vine_only_set.product_id).alias(\u0027unique_product_id\u0027)).collect()",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:38.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "[Row(unique_product_id\u003d149694)]",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-175559_636007462",
      "dateCreated": "2019-05-06 17:55:59.000",
      "dateStarted": "2019-05-06 22:09:31.843",
      "dateFinished": "2019-05-06 22:09:38.573",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nvine_titles \u003d vine_only_set.select([\"product_id\"])",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:38.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-175618_1987647402",
      "dateCreated": "2019-05-06 17:56:18.000",
      "dateStarted": "2019-05-06 22:09:38.575",
      "dateFinished": "2019-05-06 22:09:38.687",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\nvine_titles_only \u003d vine_titles.dropDuplicates()\n\nvine_titles_only.show(5)",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:44.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----------+\n|product_id|\n+----------+\n|B005FMZX9Q|\n|B0057Z253I|\n|B00ATUKQG4|\n|B005FN0XY0|\n|B00HA062MS|\n+----------+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-175725_1917079293",
      "dateCreated": "2019-05-06 17:57:25.000",
      "dateStarted": "2019-05-06 22:09:38.689",
      "dateFinished": "2019-05-06 22:09:44.578",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_watches_no_vine \u003d vine_no_set.join(vine_titles_only, vine_no_set.product_id \u003d\u003d vine_titles.product_id, \u0027inner\u0027).select(vine_no_set.customer_id, vine_no_set.product_id, vine_no_set.product_title, vine_no_set.star_rating, vine_no_set.helpful_votes, vine_no_set.total_votes, vine_no_set.vine)\n\ncommon_watches_no_vine.show(5)",
      "user": "",
      "dateUpdated": "2019-05-06 22:09:52.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|customer_id|product_id|       product_title|star_rating|helpful_votes|total_votes|vine|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|   20869514|B005FMZX9Q|Invicta Men\u0027s 151...|          5|            0|          0|   N|\n|   17563004|B005FMZX9Q|Invicta Men\u0027s 151...|          5|            0|          0|   N|\n|   10702793|B005FMZX9Q|Invicta Men\u0027s 151...|          5|            0|          0|   N|\n|   16266974|B005FMZX9Q|Invicta Men\u0027s 151...|          5|            1|          1|   N|\n|    1853901|B005FMZX9Q|Invicta Men\u0027s 151...|          5|            0|          0|   N|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-180455_364614134",
      "dateCreated": "2019-05-06 18:04:55.000",
      "dateStarted": "2019-05-06 22:09:44.579",
      "dateFinished": "2019-05-06 22:09:52.982",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\navg_df2 \u003d common_watches_no_vine.groupBy(\"vine\").avg()\navg_df2.show()",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:03.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----+--------------------+-----------------+------------------+------------------+\n|vine|    avg(customer_id)| avg(star_rating)|avg(helpful_votes)|  avg(total_votes)|\n+----+--------------------+-----------------+------------------+------------------+\n|   N|2.4488276285262417E7|4.213683223992502|0.9794985941893158|1.3118556701030928|\n+----+--------------------+-----------------+------------------+------------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-180752_521615258",
      "dateCreated": "2019-05-06 18:07:52.000",
      "dateStarted": "2019-05-06 22:09:52.986",
      "dateFinished": "2019-05-06 22:10:03.338",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_watches_no_vine_subset \u003d common_watches_no_vine.select([\"customer_id\", \"star_rating\", \"helpful_votes\", \"total_votes\"])\n\ncommon_watches_no_vine_subset.describe().show()",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:11.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-------+--------------------+-----------------+------------------+------------------+\n|summary|         customer_id|      star_rating|     helpful_votes|       total_votes|\n+-------+--------------------+-----------------+------------------+------------------+\n|  count|                8536|             8536|              8536|              8536|\n|   mean|2.4488276285262417E7|4.213683223992502|0.9794985941893158|1.3118556701030928|\n| stddev| 1.581517476150837E7| 1.23331236066199| 6.385794613637905| 7.056536605877288|\n|    min|               20147|                1|                 0|                 0|\n|    max|            53095016|                5|               305|               319|\n+-------+--------------------+-----------------+------------------+------------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-205315_921188716",
      "dateCreated": "2019-05-06 20:53:15.000",
      "dateStarted": "2019-05-06 22:10:03.340",
      "dateFinished": "2019-05-06 22:10:11.697",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_titles \u003d common_watches_no_vine.select([\"product_id\"])",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:11.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-180819_587213261",
      "dateCreated": "2019-05-06 18:08:19.000",
      "dateStarted": "2019-05-06 22:10:11.698",
      "dateFinished": "2019-05-06 22:10:11.820",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_titles.agg(countDistinct(common_titles.product_id).alias(\u0027unique_product_id\u0027)).collect()",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:19.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "[Row(unique_product_id\u003d165)]",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-180855_1327202665",
      "dateCreated": "2019-05-06 18:08:55.000",
      "dateStarted": "2019-05-06 22:10:11.822",
      "dateFinished": "2019-05-06 22:10:19.419",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_titles_only \u003d common_titles.dropDuplicates()\n\ncommon_titles_only.show(5)",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:25.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----------+\n|product_id|\n+----------+\n|B005FMZX9Q|\n|B005FN0XY0|\n|B00ATUKQG4|\n|B000FVE3AC|\n|B005FMYSEC|\n+----------+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-205751_1596946527",
      "dateCreated": "2019-05-06 20:57:51.000",
      "dateStarted": "2019-05-06 22:10:19.421",
      "dateFinished": "2019-05-06 22:10:25.970",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_watches_yes_vine \u003d vine_only_set.join(common_titles_only, vine_only_set.product_id \u003d\u003d common_titles.product_id, \u0027inner\u0027).select(vine_only_set.customer_id, vine_only_set.product_id, vine_only_set.product_title, vine_only_set.star_rating, vine_only_set.helpful_votes, vine_only_set.total_votes, vine_only_set.vine)\n\ncommon_watches_yes_vine.show(5)",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:34.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|customer_id|product_id|       product_title|star_rating|helpful_votes|total_votes|vine|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\n|   52582314|B005FMZX9Q|Invicta Men\u0027s 151...|          4|            0|          1|   Y|\n|   24876781|B005FMZX9Q|Invicta Men\u0027s 151...|          5|           47|         51|   Y|\n|   33303481|B005FMZX9Q|Invicta Men\u0027s 151...|          3|            4|          6|   Y|\n|   12979423|B005FMZX9Q|Invicta Men\u0027s 151...|          3|            0|          1|   Y|\n|   17256213|B005FMZX9Q|Invicta Men\u0027s 151...|          4|            0|          1|   Y|\n+-----------+----------+--------------------+-----------+-------------+-----------+----+\nonly showing top 5 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-205841_1925200358",
      "dateCreated": "2019-05-06 20:58:41.000",
      "dateStarted": "2019-05-06 22:10:25.972",
      "dateFinished": "2019-05-06 22:10:34.521",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\navg_df3 \u003d common_watches_yes_vine.groupBy(\"vine\").avg()\navg_df3.show()",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:44.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----+-------------------+-----------------+------------------+------------------+\n|vine|   avg(customer_id)| avg(star_rating)|avg(helpful_votes)|  avg(total_votes)|\n+----+-------------------+-----------------+------------------+------------------+\n|   Y|4.062324226999398E7|4.052315093205051| 2.942273000601323|3.8232110643415513|\n+----+-------------------+-----------------+------------------+------------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-210116_129553149",
      "dateCreated": "2019-05-06 21:01:16.000",
      "dateStarted": "2019-05-06 22:10:34.523",
      "dateFinished": "2019-05-06 22:10:44.001",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\n\ncommon_watches_yes_vine_subset \u003d common_watches_yes_vine.select([\"customer_id\", \"star_rating\", \"helpful_votes\", \"total_votes\"])\n\ncommon_watches_yes_vine_subset.describe().show()",
      "user": "",
      "dateUpdated": "2019-05-06 22:10:53.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-------+--------------------+-----------------+-----------------+------------------+\n|summary|         customer_id|      star_rating|    helpful_votes|       total_votes|\n+-------+--------------------+-----------------+-----------------+------------------+\n|  count|                1663|             1663|             1663|              1663|\n|   mean| 4.062324226999398E7|4.052315093205051|2.942273000601323|3.8232110643415513|\n| stddev|1.3040404010264717E7|0.924479424493791|11.29967194949038| 12.29075220167024|\n|    min|            10140675|                1|                0|                 0|\n|    max|            53096363|                5|              349|               370|\n+-------+--------------------+-----------------+-----------------+------------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-210923_146890653",
      "dateCreated": "2019-05-06 21:09:23.000",
      "dateStarted": "2019-05-06 22:10:44.003",
      "dateFinished": "2019-05-06 22:10:53.307",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "",
      "user": "",
      "dateUpdated": "2019-05-06 21:10:14.000",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "",
      "id": "20190506-211014_1813706639",
      "dateCreated": "2019-05-06 21:10:14.000",
      "dateStarted": "2019-05-06 21:25:02.000",
      "dateFinished": "2019-05-06 21:25:02.000",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    }
  ],
  "name": "Big_Data_HW_Watches",
  "id": "99a5d4efb40b4ffd9871b825782d2519",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {},
  "info": {}
}